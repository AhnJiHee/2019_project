package dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import vo.MemberVO;

public class MemberDAO {
	
	// 회원가입 메서드
	public void signIn (MemberVO vo){
		String result = "";
		String id = vo.getId();
		try {
			Class.forName("oracle.jdbc.driver.OracleDriver");
			Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","hr","hr");
				
			String sql = 
					"insert into member values "
					+ " ( ? , ? , ? , ? , sysdate , ?)";
			PreparedStatement pt = con.prepareStatement(sql);

			pt.setString(1, vo.getId());
			pt.setString(2, vo.getPassword());
			pt.setString(3, vo.getName());
			pt.setString(4, vo.getPhone());
			pt.setString(5, vo.getEmail());	
				
			int insertRow = pt.executeUpdate();
			if( insertRow==1) {
				result = "회원가입이 완료되었습니다.";			
			} else {
			}
			con.close();
		}// 연결 해제
		// 오류 처리
		catch(Exception e) {
			result = "회원가입 미완료되었습니다.";
			e.printStackTrace();
		}
	}
	// 회원조회 메서드
	
	public String ifmember (String id, String password) {
		String result = "";
		try {
			Class.forName("oracle.jdbc.driver.OracleDriver");
			Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","hr","hr");
				
			String sql = 
					"select password from member where id = ?";
			PreparedStatement pt = con.prepareStatement(sql);
			pt.setString(1, id);
			pt.executeUpdate();
			ResultSet rs = pt.executeQuery();
			rs.next();
			String pwcheck = rs.getString("password");
			if( pwcheck.equals(password)) {
				result = "정상적으로 로그인 되었습니다";
			} else if ( ! pwcheck.equals(password)){
				result = "비밀번호를 확인하십시오";
			} else {
				result = "회원이 아닙니다";
			}
			con.close();
		}// 연결 해제
		// 오류 처리
		catch(Exception e) {
			result = "오류가 발생하였습니다.";
			e.printStackTrace();
		}
		return result;
	}
	
} //MemberDAO end

